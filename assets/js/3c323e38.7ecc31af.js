"use strict";(self.webpackChunkcausadb_docs=self.webpackChunkcausadb_docs||[]).push([[9534],{161:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>d,toc:()=>c});var s=n(5893),i=n(1151);const a={sidebar_position:1},o="Model Querying",d={id:"guide/causadb/querying",title:"Model Querying",description:"CausaDB models are designed to understand the causal structure of your data. This means that you can query the model to understand the causal relationships between variables, make predictions about the effects of actions, and attribute causality to different variables, among other things.",source:"@site/docs/guide/causadb/querying.md",sourceDirName:"guide/causadb",slug:"/guide/causadb/querying",permalink:"/docs/guide/causadb/querying",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"guideSidebar",previous:{title:"Organisations",permalink:"/docs/guide/causadb/organisations"},next:{title:"Command Line Interface",permalink:"/docs/guide/causadb/cli"}},r={},c=[{value:"Simulate actions",id:"simulate-actions",level:2},{value:"Find best actions",id:"find-best-actions",level:2},{value:"Causal effects",id:"causal-effects",level:2},{value:"Causal attribution",id:"causal-attribution",level:2}];function l(e){const t={admonition:"admonition",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{id:"model-querying",children:"Model Querying"}),"\n",(0,s.jsx)(t.p,{children:"CausaDB models are designed to understand the causal structure of your data. This means that you can query the model to understand the causal relationships between variables, make predictions about the effects of actions, and attribute causality to different variables, among other things."}),"\n",(0,s.jsx)(t.p,{children:"Once a model is trained on your data, you can run a variety of queries for different purposes. This guide will walk you through some of the most common queries you might want to run on your model."}),"\n",(0,s.jsx)(t.h2,{id:"simulate-actions",children:"Simulate actions"}),"\n",(0,s.jsx)(t.p,{children:"Simulating actions is a common use case for causal models. You can simulate the effects of setting a node or set of nodes to a specific value, and then see how the remaining variables change. Only nodes downstream of the actionable nodes will change, as causality cannot act backwards. This function is useful for understanding the impact of taking actions, or for making predictions."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Example:"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'model.simulate_actions(actions={\n  "heating": 46,\n  "outdoor_temp": 13\n})["median"]\n'})}),"\n",(0,s.jsxs)(t.p,{children:["This will return the expected values of all nodes in the model when the ",(0,s.jsx)(t.code,{children:"heating"})," node is set to 46 and the ",(0,s.jsx)(t.code,{children:"outdoor_temp"})," node is set to 13."]}),"\n",(0,s.jsx)(t.p,{children:"This is a useful function for making predictions or understanding the impact of potential interventions and actions."}),"\n",(0,s.jsx)(t.h2,{id:"find-best-actions",children:"Find best actions"}),"\n",(0,s.jsx)(t.p,{children:"As well as simulating actions, another common use case is to find the best actions to take in order to achieve a specific goal. This is done by optimising the values of actionable node for a given target node. This can be done while unactionable nodes are fixed to specific values or allowed to vary."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Example:"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'best_actions = model.find_best_actions(\n    targets={"indoor_temp": 19},\n    actionable=["heating"],\n    fixed={"outdoor_temp": 16}\n)\n'})}),"\n",(0,s.jsxs)(t.p,{children:["This will return the optimal value for the ",(0,s.jsx)(t.code,{children:"heating"})," node in order to achieve an ",(0,s.jsx)(t.code,{children:"indoor_temp"})," of 19, while the ",(0,s.jsx)(t.code,{children:"outdoor_temp"})," is fixed at 16."]}),"\n",(0,s.jsx)(t.p,{children:"This is a useful function for making recommendations or optimising decisions."}),"\n",(0,s.jsx)(t.h2,{id:"causal-effects",children:"Causal effects"}),"\n",(0,s.jsx)(t.p,{children:"Causal effects are the effects of changing a node or set of nodes on the other nodes in the model. This function allows you to understand the change in outcomes when an action is taken. Causal effects are always calculated between the current state of the model and the state after the action is taken. This is akin to regression coefficients or marginal effects in classical causal inference methods, but with the added benefit of being able to calculate the effects of multiple actions simultaneously."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Example:"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'model.causal_effects({"heating": [50, 55]}, fixed={"outdoor_temp": 15})\n'})}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{}),(0,s.jsx)(t.th,{children:"median"}),(0,s.jsx)(t.th,{children:"lower"}),(0,s.jsx)(t.th,{children:"upper"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"day"}),(0,s.jsx)(t.td,{children:"0.000000"}),(0,s.jsx)(t.td,{children:"0.000000"}),(0,s.jsx)(t.td,{children:"0.000000"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"outdoor_temp"}),(0,s.jsx)(t.td,{children:"0.000000"}),(0,s.jsx)(t.td,{children:"0.000000"}),(0,s.jsx)(t.td,{children:"0.000000"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"heating"}),(0,s.jsx)(t.td,{children:"5.000000"}),(0,s.jsx)(t.td,{children:"5.000000"}),(0,s.jsx)(t.td,{children:"5.000000"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"indoor_temp"}),(0,s.jsx)(t.td,{children:"1.295403"}),(0,s.jsx)(t.td,{children:"1.135942"}),(0,s.jsx)(t.td,{children:"1.454892"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"energy"}),(0,s.jsx)(t.td,{children:"43.059056"}),(0,s.jsx)(t.td,{children:"40.899418"}),(0,s.jsx)(t.td,{children:"45.263778"})]})]})]}),"\n",(0,s.jsxs)(t.p,{children:["In this example, the causal effects of setting the ",(0,s.jsx)(t.code,{children:"heating"})," node to 55 from 50 are calculated, while the ",(0,s.jsx)(t.code,{children:"outdoor_temp"})," node is fixed at 15. This will return the expected change in all other nodes in the model. Downstream nodes such as ",(0,s.jsx)(t.code,{children:"outdoor_temp"})," and ",(0,s.jsx)(t.code,{children:"day"})," will not change, as they are not affected by the ",(0,s.jsx)(t.code,{children:"heating"})," node."]}),"\n",(0,s.jsx)(t.h2,{id:"causal-attribution",children:"Causal attribution"}),"\n",(0,s.jsx)(t.p,{children:"Causal attribution is the process of attributing the value of an outcome node to the values of the input nodes. This function allows you to understand the importance of different nodes in the model for a particular outcome node. It is similar to feature importance in machine learning models, but with a causal interpretation."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Example:"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'causal_attributions = model.causal_attributions("energy")\ncausal_attributions\n'})}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{}),(0,s.jsx)(t.th,{children:"energy"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"outdoor_temp"}),(0,s.jsx)(t.td,{children:"-25.130205"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"heating"}),(0,s.jsx)(t.td,{children:"8.639587"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"indoor_temp"}),(0,s.jsx)(t.td,{children:"2.948999"})]})]})]}),"\n",(0,s.jsxs)(t.p,{children:["In this example, the causal attributions of the ",(0,s.jsx)(t.code,{children:"energy"})," node are calculated. This will return the expected contribution of each node to the value of the ",(0,s.jsx)(t.code,{children:"energy"})," node. It is important to interpret these results in the context of the model, as the causal pathways can sometimes be indirect."]}),"\n",(0,s.jsx)(t.admonition,{type:"note",children:(0,s.jsx)(t.p,{children:"We're working on adding new explainability features to CausaDB that go beyond causal attributions, so stay tuned for more updates."})})]})}function h(e={}){const{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},1151:(e,t,n)=>{n.d(t,{Z:()=>d,a:()=>o});var s=n(7294);const i={},a=s.createContext(i);function o(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);